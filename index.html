<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
    <head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<title>Spirit Island Tracker</title>
		
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
		
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Cantora+One&display=swap" rel="stylesheet">

      	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

		<link rel="stylesheet" type="text/css" href="style.css">
    </head>
	
    <body>

		<!-- Game Setup Modal -->
		<div class="modal fade" id="setup-modal" tabindex="-1" role="dialog" aria-labelledby="gameSetupModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
			<div class="modal-dialog modal-dialog-centered modal-fullscreen" role="document">
				<div class="modal-content">
					<div class="modal-header" style="justify-content: center;">
						<h1 class="modal-title" id="gameSetupModalLabel">Welcome to Spirit Island Tracker</h1>
					</div>
					<div class="modal-body">
						<div class="row">
							
							<div class="col-md-1"></div>
							<div class="col-md-4">
								<form id="gameSetupForm">
									<!-- Player Count -->
									<div class="form-group">
										<label class="font-weight-bold mb-3">Number of Players</label>
										<div class="d-flex flex-wrap">
											<div class="form-check">
												<input class="form-check-input" type="radio" name="playerCount" id="player1" value="1">
												<label class="form-check-label" for="player1">
													1
												</label>
											</div>
											<div class="form-check">
												<input class="form-check-input" type="radio" name="playerCount" id="player2" value="2" checked>
												<label class="form-check-label" for="player2">
													2 
												</label>
											</div>
											<div class="form-check">
												<input class="form-check-input" type="radio" name="playerCount" id="player3" value="3">
												<label class="form-check-label" for="player3">
													3
												</label>
											</div>
											<div class="form-check">
												<input class="form-check-input" type="radio" name="playerCount" id="player4" value="4">
												<label class="form-check-label" for="player4">
													4 
												</label>
											</div>
											<div class="form-check">
												<input class="form-check-input" type="radio" name="playerCount" id="player5" value="5">
												<label class="form-check-label" for="player5">
													5 
												</label>
											</div>
											<div class="form-check">
												<input class="form-check-input" type="radio" name="playerCount" id="player6" value="6">
												<label class="form-check-label" for="player6">
													6 
												</label>
											</div>
										</div>
										
									</div>
									<hr>
									<!-- Adversary Choice -->
									<div class="form-group mt-4">
										<label class="font-weight-bold mb-3">Adversary</label>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advNone" value="none" data-image="" checked>
											<label class="form-check-label" for="advNone">
												No Adversary
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advBrandenburg" value="prussia" data-image="prussia.jpg">
											<label class="form-check-label" for="advBrandenburg">
												Brandenburg-Prussia
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advEngland" value="england" data-image="england.jpg">
											<label class="form-check-label" for="advEngland">
												England
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advSweden" value="sweden" data-image="sweden.jpg">
											<label class="form-check-label" for="advSweden">
												Sweden
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advFrance" value="france" data-image="france.jpg">
											<label class="form-check-label" for="advFrance">
												France
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advHabsburgLivestock" value="habsburg-livestock" data-image="habsburg-livestock.jpg">
											<label class="form-check-label" for="advHabsburgLivestock">
												Habsburg (Livestock Colony)
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advRussia" value="russia" data-image="russia.jpg">
											<label class="form-check-label" for="advRussia">
												Russia
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advScotland" value="scotland" data-image="scotland.jpg">
											<label class="form-check-label" for="advScotland">
												Scotland
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input adversary-radio" type="radio" name="adversary" id="advHabsburgMining" value="habsburg-mining" data-image="habsburg-mining.jpg">
											<label class="form-check-label" for="advHabsburgMining">
												Habsburg (Mining Expedition)
											</label>
										</div>
									</div>
									
									<!-- Adversary Level (conditional) -->
									<div class="form-group mt-3" id="adversaryLevelGroup" style="display: none;">
										<label for="adversaryLevel" class="font-weight-bold">Adversary Level</label>
										<select class="form-control" id="adversaryLevel">
											<option value="0">0</option>
											<option value="1" selected>1</option>
											<option value="2">2</option>
											<option value="3">3</option>
											<option value="4">4</option>
											<option value="5">5</option>
											<option value="6">6</option>
										</select>
										
									</div>
									<hr>
									<!-- Expansions -->
									<div class="form-group mt-4">
										<label class="font-weight-bold mb-3">Expansions Used</label>
										<div class="form-check">
											<input class="form-check-input" type="checkbox" value="branch-claw" id="expansionBranchClaw">
											<label class="form-check-label" for="expansionBranchClaw">
												Branch & Claw
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input" type="checkbox" value="jagged-earth" id="expansionJaggedEarth">
											<label class="form-check-label" for="expansionJaggedEarth">
												Jagged Earth
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input" type="checkbox" value="feather-flame" id="expansionFeatherFlame">
											<label class="form-check-label" for="expansionFeatherFlame">
												Feather & Flame
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input" type="checkbox" value="natures-incarnate" id="expansionNaturesIncarnate">
											<label class="form-check-label" for="expansionNaturesIncarnate">
												Nature Incarnate
											</label>
										</div>
									</div>
								</form>
							</div>

							<!-- Preview Column -->
							<div class="col-md-6">
								<div class="adversary-preview-container container-glassmorphism">
									<div id="adversaryPreview" class="adversary-preview">
										<div class="preview-placeholder">
											<i class="text-muted">Select an adversary to see preview</i>
										</div>
									</div>
								</div>
							</div>

							<div class="col-md-1"></div>
						</div>
					</div>
					<div class="modal-footer justify-content-center">
						<button type="button" class="btn btn-primary" id="startGameBtn">Start Game</button>
					</div>

				</div>
			</div>
		</div>

		<div class="container-fluid">
			<div class="row main-container">
				<div class="col-md-3">
					<div class="left-bar fear-panel-top">


						<p id="fear-cards-remaining-container">Fear Cards Remaining:    
							<span class="badge text-bg-dark fear-cards-remaining-badge">1</span> /
							<span class="badge text-bg-dark fear-cards-remaining-badge">4</span> /
							<span class="badge text-bg-dark fear-cards-remaining-badge">4</span>
						</p>

						<hr>

						<span class="badge text-bg-dark fear-panel-top-title" id="fear-cards-next-level">1</span>
						cards until next Terror Level

						<hr>

						<p>Earned this turn: <span class="badge text-bg-dark fear-badge" id="left-bar-fear-badge">2</span></p>

						<hr>

						<div class="card container-glassmorphism fear-panel-bottom" data-bs-theme="dark">
							<h5 class="card-header">
								Earned fear
							</h5>
							<div class="card-body">
								<div class="progress">
									<div class="progress-bar" id='fear-progress' style="width: 0%;"></div>
								</div>
							</div>
							<div class="card-footer">
								<button type="button" class="btn btn-secondary" style="width:45%;margin-right: 24px;" id='btn-add-fear' onclick="addFear(1)">
									+1 <img src="./assets/symbol/fear.png" class="d-inline inverted" style="height:1em;">
								</button>
								<button type="button" class="btn btn-secondary" style="width:45%;" id='btn-add-fear-2' onclick="addFear(2)">
									+2 <img src="./assets/symbol/fear.png" class="d-inline inverted" style="height:1em">
								</button>

								<button type="button" class="btn btn-outline-secondary remove-fear-btn" style="width:45%;margin-right: 24px;" id='btn-remove-fear' onclick="removeFear(1)">
									-1 <img src="./assets/symbol/fear.png" class="d-inline inverted" style="height:1em;">
								</button>
								<button type="button" class="btn btn-outline-secondary remove-fear-btn" style="width:45%;" id='btn-remove-fear-2' onclick="removeFear(2)">
									-2 <img src="./assets/symbol/fear.png" class="d-inline inverted" style="height:1em">
								</button>
							</div>
						</div>

					</div>

					<div class="left-bar-bottom container-glassmorphism">
						<button type="button" class="btn btn-outline-light" style="width:100%;" id='redraw-btn' onclick="redraw()">
							Redraw
						</button>
						<button type="button" class="btn btn-outline-light" style="width:100%;" id='special-action-btn' data-bs-toggle="modal" data-bs-target="#special-actions-modal">
							Special Actions
						</button>
						<button type="button" class="btn btn-outline-light" style="width:100%;" id='credits-btn' data-bs-toggle="modal" data-bs-target="#credits-modal">
							Credits & Feedback
						</button>
						<hr>
						<button type="button" class="btn btn-outline-danger" style="width:100%;" onclick="startNewGame()">
							New Game
						</button>
					</div>

				</div>
				<div class="col-md-9">
					<div class="row main-area">
						<div class="col-md-3 phase-list-container">
							<div class="list-group phase-list" id="phase-list">

							</div>

							<div>
								<button type="button" class="btn btn-success phase-list-btn" style="width:100%;" id="btn-next-phase" onclick="nextStep()">
									Next step
								</button>
								
								<button type="button" class="btn btn-secondary phase-list-btn" style="width:100%;" id="btn-undo" onclick="undo()">
									Undo
								</button>
							</div>
							
						</div>

						<div class="col-md-6 main-card-display container-glassmorphism" id="main-card-display"> </div>

						<div class="col-md-3">
							<div class="right-bar">
								<div id="terror-level-container" style="align-content: center;display: flex;"></div>

								<hr>

								<div class="card container-glassmorphism right-bar-card" data-bs-theme="dark">
									<div class="card-body">
										<div class="row">
											<div class="col-md-6">
												<span style="vertical-align: middle;">Event</span> 
											</div>
										</div>
										<div>
											Player count: <span class="badge text-bg-dark" id="player-count-display">2</span> 
											<br>
											Turn: <span class="badge text-bg-dark" id="turn-count-display">1</span> / <span class="badge text-bg-dark" id="total-turn-count-display">9</span>
											<br>
											Adversary: <span class="badge text-bg-dark" id="adversary-name-display">Brandenburg-Prussia 6</span> 
											<br>
											Invader Cards Remaining: <span class="badge text-bg-dark" id="invader-level-sequence"></span>
										</div>

										<hr>

										<h5>Card Histories</h5>
										<div style="text-align: left;">
											<button type="button" id="show-adversary-card-btn" class="btn btn-secondary btn-sm" onclick="showAdversaryCard()">Adversary Card</button>
											<div class="row">
												<div class="col-md-4">
													<span style="vertical-align: middle;">Event</span> 
												</div>
												<div class="col-md-8" style="text-align: right;">
													<button type="button" id="last-event-card-btn" class="btn btn-secondary btn-sm history-btn" onclick="displayCardHistory('event', -1)">
														<i class="bi bi-caret-left-fill"></i>
													</button>
													<button type="button" id="next-event-card-btn" class="btn btn-secondary btn-sm history-btn" onclick="displayCardHistory('event', 1)">
														<i class="bi bi-caret-right-fill"></i>
													</button>	
													<button type="button" id="this-event-card-btn" class="btn btn-secondary btn-sm history-btn" onclick="displayCardHistory('event', 0)" disabled>
														<span style="font-size: 1rem;">Latest</span>
													</button>
												</div>
											</div>
											<div class="row">
												<div class="col-md-4">
													<span style="vertical-align: middle;">Fear</span> 
												</div> 
												<div class="col-md-8" style="text-align: right;">
													<button type="button" id="last-fear-card-btn" class="btn btn-secondary btn-sm history-btn" onclick="displayCardHistory('fear', -1)">
														<i class="bi bi-caret-left-fill"></i>
													</button>
													<button type="button" id="next-fear-card-btn" class="btn btn-secondary btn-sm history-btn" onclick="displayCardHistory('fear', 1)">
														<i class="bi bi-caret-right-fill"></i>
													</button>
													<button type="button" id="this-fear-card-btn" class="btn btn-secondary btn-sm history-btn" onclick="displayCardHistory('fear', 0)" disabled>
														<span style="font-size: 1rem;">Latest</span>
													</button>
												</div>
											</div>
										</div>
										
									</div>	
								</div>

							</div>
						</div>
					</div>

					<div class="row invader-area container-glassmorphism">
						<div class="col-md-2 invader-card-area">
							<div class="invader-card-container" id="invader-card-fourth"> 
								
							</div>
							<div class="invader-card-label">
								Discard
							</div>
						</div>

						<div class="col-md-1 invader-card-arrow">
							&lt;
						</div>

						<div class="col-md-2 invader-card-area">
							<div class="invader-card-container" id="invader-card-ravage"> 
								<img src="./assets/invader/1s.jpg" class="game-card game-card-invader">
							</div>
							<div class="invader-card-label">
								Ravage
							</div>
						</div>

						<div class="col-md-1 invader-card-arrow">
							&lt;
						</div>

						<div class="col-md-2 invader-card-area">
							<div class="invader-card-container" id="invader-card-build"> 
								<img src="./assets/invader/1w.jpg" class="game-card game-card-invader">
							</div>
							<div class="invader-card-label">
								Build
							</div>
						</div>

						<div class="col-md-1 invader-card-arrow">
							&lt;
						</div>

						<div class="col-md-2 invader-card-area">
							<div class="invader-card-container" id="invader-card-explore"> 
								<img src="./assets/invader/1.jpg" class="game-card game-card-invader">
							</div>
							<div class="invader-card-label">
								Explore
							</div>
						</div>



					</div>
				</div>
			</div>
		</div>

		<!-- Special Actions Modal -->
		<div class="modal fade" id="special-actions-modal" tabindex="-1" role="dialog" aria-labelledby="specialActionsModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
				<div class="modal-content">
					<div class="modal-body">

						<div class="special-action-section">
							<b>France</b>
							
							<div>
								Slave Rebellion (Event)
								<button type="button" class="btn btn-warning special-action-btn" onclick="slaveRebellion(0)">
									Small Uprising (Invader Stage I or II)
								</button>

								<button type="button" class="btn btn-danger special-action-btn" onclick="slaveRebellion(1)">
									Rebellion (Invader Stage III)
								</button>
							</div>
						</div>

						<hr>

						<div class="special-action-section">
							<b>Fractured Days Split the Sky (Visions of a Shifting Future)</b>
							
							<div>
								Top power (look then shuffle): 
								<button type="button" class="btn btn-secondary special-action-btn" onclick="fracturedDaysPower(0, 0)">
									Invader
								</button>

								<button type="button" class="btn btn-warning special-action-btn" onclick="fracturedDaysPower(1, 0)">
									Event
								</button>
								
								<br>

								Bottom power (look then return to top or bottom): 
								<button type="button" class="btn btn-secondary special-action-btn" onclick="fracturedDaysPower(0, 1)">
									Invader
								</button>

								<button type="button" class="btn btn-warning special-action-btn" onclick="fracturedDaysPower(1, 1)">
									Event
								</button>

								<br>

								(Bottom power only) Return top card to bottom of deck:  

								<button type="button" class="btn btn-secondary special-action-btn" onclick="fracturedDaysPower(0, 9)">
									Invader
								</button>
								<button type="button" class="btn btn-warning special-action-btn" onclick="fracturedDaysPower(1, 9)">
									Event
								</button>
							</div>
						</div>

					</div>
					<div class="modal-footer justify-content-center">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Credits Modal -->
		<div class="modal fade" id="credits-modal" tabindex="-1" role="dialog" aria-labelledby="creditsModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					
					<div class="modal-body text-center">

						<h4>Created by <strong>lndrchan</strong></h4>
						
						<hr>
						
						<div class="d-grid">
							<a href="https://github.com/lndrchan/Spirit-Island-Tracker/issues" 
							target="_blank" 
							class="btn btn-primary btn-lg">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github me-2" viewBox="0 0 16 16">
									<path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
								</svg>
								Bug Report / Feature Request
							</a>
							
							<a href="https://ko-fi.com/yourusername" 
							target="_blank" 
							class="btn btn-success btn-lg">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart-fill me-2" viewBox="0 0 16 16">
									<path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
								</svg>
								Support via Donation
							</a>
						</div>
						
						<hr>
						
						<p class="text-muted small mb-0">
							Spirit Island is a board game by R. Eric Reuss<br>
							This is an unofficial companion tool
						</p>
					</div>
					<div class="modal-footer justify-content-center">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>

		<div class="background-blur"></div>

		<script src="adversary-config.js"></script>
		<script src="main.js"></script>
		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
		
  
    </body>
</html>

